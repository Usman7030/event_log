"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const streams_grpc_pb_1 = require("../../../generated/streams_grpc_pb");
const Client_1 = require("../../Client");
const constants_1 = require("../../constants");
const append_1 = require("./append");
const batchAppend_1 = require("./batchAppend");
Client_1.Client.prototype.appendToStream = async function (streamName, event, { expectedRevision = constants_1.ANY, batchAppendSize = 3 * 1024 * 1024, ...baseOptions } = {}) {
    const events = Array.isArray(event) ? event : [event];
    if (!baseOptions.credentials &&
        (await this.supports(streams_grpc_pb_1.StreamsService.batchAppend))) {
        return batchAppend_1.batchAppend.call(this, streamName, events, {
            expectedRevision,
            batchAppendSize,
            ...baseOptions,
        });
    }
    return append_1.append.call(this, streamName, events, {
        expectedRevision,
        batchAppendSize,
        ...baseOptions,
    });
};
